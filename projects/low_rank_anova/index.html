<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Libin  Liang | Low rank Anova model</title>
    <meta name="author" content="Libin  Liang" />
    <meta name="description" content="Assuming low rank structure in the interaction effect" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/sigma.png"/>
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://libinliang866.github.io/projects/low_rank_anova/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://libinliang866.github.io/"><span class="font-weight-bold">Libin</span>   Liang</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">teaching</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Low rank Anova model</h1>
            <p class="post-description">Assuming low rank structure in the interaction effect</p>
          </header>

          <article>
            <p>To model the multivariate function, One concept is the additive model.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_1-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_1-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_1-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_1.png">

  </picture>

</figure>

<p>And extended from additive modeling, functional analysis-of-variance modeling can help us to capture not only the main effect but also multi-way interaction effect of the covariates.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_2-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_2-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_2-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_2.png">

  </picture>

</figure>

<p>One issue for ANOVA modeling is the number of parameters grows exponentially as the number of covariates grows. Suppose we use the a set of spline basics with p elements, typically we will fit the interaction term by a linear combination of the tensor product basics based on the spline basics. Then there will be k power of p parameters for the k-way interaction term.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_3-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_3-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_3-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_3.png">

  </picture>

</figure>

<p>To address this problem, we assume that the multi-way interaction term has a low rank structure and we propose the low rank ANOVA modeling as shown in the formula. Suppose there are 3 covariates. The multi-way interaction term can be expressed as a product of 1-dimsional function of the covariates, By doing so, we can reduce the parameters significantly. For a set of spline basics with p elements, the number of parameters for 3-way interaction term will reduced to p*3 instead of cubic of p for the traditional ANOVA modeling.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_4-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_4-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_4-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_4.png">

  </picture>

</figure>

<p>To help selecting the spline basics and interaction terms, we introduce the total variation penalty and the empirical norm penalty. With the truncated power basics, the total variation of the m-1 order derivation can be reformed as lasso penalty. So that the total variation will achieve sparse selection of knots. The empirical norm can be reformed as the L2 penalty composite with a linear transformation. And the empirical norm will help us achieve selection of interaction term.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_5-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_5-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_5-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_5.png">

  </picture>

</figure>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_6-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_6-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_6-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_6.png">

  </picture>

</figure>

<p>For a certain spline basic with p elements, the low rank ANOVA model can be express as formula (1). Where the star operator here represents the Hadamard product. The Phis are design matrix decide by the spline basic we choose and beta are parameters we try to fit. If we do the lease square, the loss function is not convex with respect to the whole set of parameters.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_7-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_7-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_7-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_7.png">

  </picture>

</figure>

<p>Fortunately, the loss function is convex with respect to a specific component of beta if we fixed the other. If we apply the truncated power basic and apply the total variation and empirical norm penalty , now we are trying to update the component of x1 from the interaction effect between x1 and x2, then we actually try to solve the problem as formula (2). This is a convex problem with respect to beta and actually a double penalized lease square problem. So we can apply the alternating penalized lease square scheme to fit the model. That is, we iteratively choose a component from the components set, and then we update the chosen component but make other components fixed, that is we try to solve a subproblem similar as formula (2) in each iteration.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_8-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_8-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_8-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_8.png">

  </picture>

</figure>

<p>Now we discuss how to solve the double penalized least square problem we just mentioned. The subproblem can be generally formulate as equation (3). To solve the subproblem, we introduce the chambolle-pock algorithm which is a kind of primal-dual method. The objective of the algorithm is to minimize the sum of two convex function and one of them is composited with a linear transformation. Rewrite the H(Lx) in the conjugated form we have the formular as (5). And x star y star is a minimizer of (4) if and only if x star and y star is a saddle point of (5). The chambolle-pock algorithm is trying to find the saddle point of (5).</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_9-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_9-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_9-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_9.png">

  </picture>

</figure>

<p>The chambolle-pock algorithm is shown here. It actually apply the proximal operator iteratively on the function G and H star to update x and y. And The proximal operator is defined as a minimization problem with a squared distance regularization. Then we can apply the chambolle-pock algorithm to solve the sub-problem in our setting. As we now can solve the sub-problem in each iteraction, then we can apply the alternating penalized least square to fit the model.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_10-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_10-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_10-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_10.png">

  </picture>

</figure>

<p>Then we will show some preliminary numerical results of the model. The simulation setting are as follow. The sample size is 500 and there will be 3 variables, the true model is the low rank ANOVA model with up to 2-way interaction. The true functional components are linear combinations of the truncated power basics with 3 or 4 knots and m = 2, which means the functional components are piece-wise linear function. To introduce the sparsity, there is a probability of 0.2 that the parameters entries to be set as 0. The noise level is 5% of the standard deviation of the response. And we will compare two model, the first one is the low rank ANOVA model with up to 2-way interaction. The second model is the full ANOVA model, that is the interaction term is assumed to be a linear combination of tensor product basics. To handle the entries-wise sparsity, we will apply the total variation penalty for model 1 and lasso penalty for model 2. The hyper-parameters for the penalty are selected by Cross-validation.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_11-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_11-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_11-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_11.png">

  </picture>

</figure>

<p>The comparison criteria is straight-forward and we just compare the squared distance between the estimate parameters and true parameters. And the table show the results. As the low rank ANOVA model problem is not convex and the alternating methods may find the local minimizers so we will repeat 10 times and report the mean and standard deviation of the estimate error for the low rank ANOVA model. From the table we can see the low rank model have a slight advantage over the full model when there is number of knots is 3 and have a significant advantage when the number of knots is 4.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_12-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_12-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_12-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_12.png">

  </picture>

</figure>

<p>Then we try to have a more straight-forward view of the interaction effect. We can see both the estimator from the Low rank model, which is in the middle column and estimator from the full model which is in the right column can capture the main feature of the interaction effect. And Low rank model can capture more detailed feature as we can see in the interaction effect between x1 and x3. 
These results show that the low rank ANOVA model can have some advantage over the full ANOVA model if the true model do have a low rank structure.</p>

<figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/lr_13-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/lr_13-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/lr_13-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/lr_13.png">

  </picture>

</figure>


          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2022 Libin  Liang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

